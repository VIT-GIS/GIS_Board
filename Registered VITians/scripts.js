const _0x26d8d0=_0x420d;function _0x2851(){const _0x3548ca=['1938vcfQBj','You\x20have\x20been\x20logged\x20out.','forEach','includes','124hdbmzY','125864fiwYbd','VITians','267140hsUWfv','toDate','logout-btn','message','4001676FuatQW','click','sahildinesh.zambre2023@vitstudent.ac.in','toLowerCase','push','144eGRPvd','catch','1MVouZO','short','VITians_Data.xlsx','data','then','getElementById','filter','utils','toLocaleString','\x0a\x20\x20\x20\x20\x20\x20<td>','4175WywPOy','writeFile','https://board.geospatialvit.site/','en-US','2-digit','name','map','117NwElrz','timestamp','download-btn','rohit.lalbahadur2023@vitstudent.ac.in','href','1:759209581914:web:3432c0511eba57eca66763','#data-table\x20tbody','Please\x20log\x20in\x20to\x20access\x20this\x20page.','json_to_sheet','querySelector','759209581914','location','Error\x20fetching\x20real-time\x20data:\x20','input','253jAAjwW','innerHTML','vitgis-ba14f','285762DZKRPX','478044hTAtps','VITians\x20Data','Unauthorized\x20access!\x20Redirecting\x20to\x20login...','vitgis-ba14f.appspot.com','</td>\x0a\x20\x20\x20\x20\x20\x20<td>','AIzaSyCvg1AhjEd9vIiYWgqQlI5BO0jU3AF84t8','N/A','addEventListener','5439njaHwZ','error','phone','email','search-input','regNumber','numeric'];_0x2851=function(){return _0x3548ca;};return _0x2851();}(function(_0x140921,_0x1166ff){const _0x37d2d9=_0x420d,_0x4dcebf=_0x140921();while(!![]){try{const _0x416b16=parseInt(_0x37d2d9(0x178))/0x1*(parseInt(_0x37d2d9(0x156))/0x2)+parseInt(_0x37d2d9(0x15f))/0x3*(parseInt(_0x37d2d9(0x16a))/0x4)+parseInt(_0x37d2d9(0x182))/0x5*(parseInt(_0x37d2d9(0x166))/0x6)+-parseInt(_0x37d2d9(0x171))/0x7+-parseInt(_0x37d2d9(0x16b))/0x8*(parseInt(_0x37d2d9(0x176))/0x9)+parseInt(_0x37d2d9(0x16d))/0xa*(parseInt(_0x37d2d9(0x153))/0xb)+parseInt(_0x37d2d9(0x157))/0xc*(parseInt(_0x37d2d9(0x189))/0xd);if(_0x416b16===_0x1166ff)break;else _0x4dcebf['push'](_0x4dcebf['shift']());}catch(_0x3ed59d){_0x4dcebf['push'](_0x4dcebf['shift']());}}}(_0x2851,0x96f6c));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js';import{getAuth,onAuthStateChanged,signOut}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js';import{getFirestore,collection,onSnapshot}from'https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js';import*as _0x5c5c81 from'https://cdn.sheetjs.com/xlsx-0.19.3/package/xlsx.mjs';const firebaseConfig={'apiKey':_0x26d8d0(0x15c),'authDomain':'vitgis-ba14f.firebaseapp.com','projectId':_0x26d8d0(0x155),'storageBucket':_0x26d8d0(0x15a),'messagingSenderId':_0x26d8d0(0x193),'appId':_0x26d8d0(0x18e)},app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),allowedEmails=[_0x26d8d0(0x173),'ajitesh.sharma2023@vitstudent.ac.in','raybanpranav.mahesh2023@vitstudent.ac.in',_0x26d8d0(0x18c)];function checkAuthorization(){onAuthStateChanged(auth,_0xbb7380=>{const _0x3f0dfe=_0x420d;if(_0xbb7380){const _0x2edd42=_0xbb7380[_0x3f0dfe(0x162)];!allowedEmails[_0x3f0dfe(0x169)](_0x2edd42)?(alert(_0x3f0dfe(0x159)),window[_0x3f0dfe(0x150)][_0x3f0dfe(0x18d)]='https://board.geospatialvit.site/'):fetchAndDisplayData();}else alert(_0x3f0dfe(0x190)),window[_0x3f0dfe(0x150)][_0x3f0dfe(0x18d)]='https://board.geospatialvit.site/';});}function fetchAndDisplayData(){const _0x1f4316=_0x26d8d0,_0x1bcc7f=document[_0x1f4316(0x192)](_0x1f4316(0x18f)),_0x294259=document['getElementById'](_0x1f4316(0x163));onSnapshot(collection(db,_0x1f4316(0x16c)),_0x6c6f68=>{const _0xc51cb9=_0x1f4316,_0xabc7c5=[];_0x6c6f68[_0xc51cb9(0x168)](_0x5858d1=>_0xabc7c5[_0xc51cb9(0x175)](_0x5858d1[_0xc51cb9(0x17b)]())),renderTable(_0xabc7c5),_0x294259[_0xc51cb9(0x15e)](_0xc51cb9(0x152),()=>{const _0x141c50=_0xc51cb9,_0x4ab7b2=_0x294259['value'][_0x141c50(0x174)](),_0x103f5d=_0xabc7c5[_0x141c50(0x17e)](_0x1a01b5=>_0x1a01b5[_0x141c50(0x164)]['toLowerCase']()[_0x141c50(0x169)](_0x4ab7b2));renderTable(_0x103f5d);}),document[_0xc51cb9(0x17d)](_0xc51cb9(0x18b))['addEventListener'](_0xc51cb9(0x172),()=>downloadExcel(_0xabc7c5));},_0x3205f1=>{const _0x125d7a=_0x1f4316;console[_0x125d7a(0x160)](_0x125d7a(0x151),_0x3205f1);});}function renderTable(_0x1cd36f){const _0x4ae3fc=_0x26d8d0,_0x1a49ea=document[_0x4ae3fc(0x192)](_0x4ae3fc(0x18f));_0x1a49ea[_0x4ae3fc(0x154)]='',_0x1cd36f['forEach'](_0x32402e=>{const _0x50bab5=_0x4ae3fc,_0x43afaf=_0x32402e[_0x50bab5(0x18a)]?formatTimestamp(_0x32402e[_0x50bab5(0x18a)]):_0x50bab5(0x15d),_0x3f03e8=document['createElement']('tr');_0x3f03e8[_0x50bab5(0x154)]=_0x50bab5(0x181)+(_0x32402e['regNumber']||_0x50bab5(0x15d))+_0x50bab5(0x15b)+(_0x32402e['name']||_0x50bab5(0x15d))+_0x50bab5(0x15b)+(_0x32402e[_0x50bab5(0x162)]||_0x50bab5(0x15d))+_0x50bab5(0x15b)+(_0x32402e['phone']||_0x50bab5(0x15d))+_0x50bab5(0x15b)+_0x43afaf+'</td>\x0a\x20\x20\x20\x20',_0x1a49ea['appendChild'](_0x3f03e8);});}function formatTimestamp(_0x81b102){const _0x52f7f8=_0x26d8d0,_0x146558=_0x81b102[_0x52f7f8(0x16e)]?_0x81b102[_0x52f7f8(0x16e)]():new Date(_0x81b102),_0x241cb4={'year':_0x52f7f8(0x165),'month':_0x52f7f8(0x179),'day':_0x52f7f8(0x165),'hour':_0x52f7f8(0x186),'minute':'2-digit','second':_0x52f7f8(0x186)};return _0x146558[_0x52f7f8(0x180)](_0x52f7f8(0x185),_0x241cb4);}function downloadExcel(_0x2a3240){const _0x1d6eb0=_0x26d8d0,_0x387825=_0x2a3240[_0x1d6eb0(0x188)](_0x5dd75b=>({'Reg.\x20Number':_0x5dd75b[_0x1d6eb0(0x164)]||_0x1d6eb0(0x15d),'Name':_0x5dd75b[_0x1d6eb0(0x187)]||'N/A','Email':_0x5dd75b['email']||_0x1d6eb0(0x15d),'Phone':_0x5dd75b[_0x1d6eb0(0x161)]||'N/A','Reg.\x20Date\x20&\x20Time':_0x5dd75b['timestamp']?formatTimestamp(_0x5dd75b['timestamp']):'N/A'})),_0xd56a56=_0x5c5c81[_0x1d6eb0(0x17f)][_0x1d6eb0(0x191)](_0x387825),_0x26e791=_0x5c5c81['utils']['book_new']();_0x5c5c81[_0x1d6eb0(0x17f)]['book_append_sheet'](_0x26e791,_0xd56a56,_0x1d6eb0(0x158)),_0x5c5c81[_0x1d6eb0(0x183)](_0x26e791,_0x1d6eb0(0x17a));}function _0x420d(_0x591793,_0x235b02){const _0x285167=_0x2851();return _0x420d=function(_0x420d48,_0x4d643f){_0x420d48=_0x420d48-0x150;let _0x32837c=_0x285167[_0x420d48];return _0x32837c;},_0x420d(_0x591793,_0x235b02);}function handleLogout(){const _0x1d94ab=_0x26d8d0;signOut(auth)[_0x1d94ab(0x17c)](()=>{const _0x466ea9=_0x1d94ab;alert(_0x466ea9(0x167)),window[_0x466ea9(0x150)][_0x466ea9(0x18d)]=_0x466ea9(0x184);})[_0x1d94ab(0x177)](_0x1e6466=>{const _0x3c68e9=_0x1d94ab;console['error']('Logout\x20failed:',_0x1e6466[_0x3c68e9(0x170)]);});}document[_0x26d8d0(0x17d)](_0x26d8d0(0x16f))?.[_0x26d8d0(0x15e)](_0x26d8d0(0x172),handleLogout),document[_0x26d8d0(0x15e)]('DOMContentLoaded',checkAuthorization);
