const _0x909b6c=_0x33a4;function _0x592b(){const _0xaf950f=['then','editPreference1','push','250rDjuWu','target','timestamp','downloadExcel','sahildinesh.zambre2023@vitstudent.ac.in','toDate','utils','1338231OFtZCp','.delete-btn','value','editPhone','.close-btn','712VXbKKh','email','searchInput','book_append_sheet','vitgis-ba14f.firebaseapp.com','getElementById','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-btn\x22\x20data-id=\x22','ajitesh.sharma2023@vitstudent.ac.in','preference2','club_enrollement','editPreference2','submit','4564wnOveG','Record\x20deleted\x20successfully','38528MwzWDT','4776662ewUKEj','phone','Enrollment\x20Data','exists','783HJphvX','AIzaSyCvg1AhjEd9vIiYWgqQlI5BO0jU3AF84t8','textContent','block','regNumber','Error\x20deleting\x20document:\x20','editRegNumber','catch','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Phone\x22>','none','editEmail','#tableBody\x20tr','preventDefault','input','raybanpranav.mahesh2023@vitstudent.ac.in','appendChild','display','editForm','Enrollment_Data.xlsx','querySelector','style','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Email\x22>','preference1','td:nth-child(2)','href','vitgis-ba14f.appspot.com','405776PiYnIy','https://board.geospatialvit.site/','addEventListener','toLowerCase','innerHTML','name','\x22>Edit</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-btn\x22\x20data-id=\x22','location','forEach','querySelectorAll','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Preference\x202\x22>','1:759209581914:web:3432c0511eba57eca66763','2302794kAtCPC','dataset','click','\x22>Delete</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Name\x22>','4IQTDNI','includes','data','editName','error','editModal','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Preference\x201\x22>','5ZWyNvC'];_0x592b=function(){return _0xaf950f;};return _0x592b();}(function(_0x2a8bf1,_0x56a9bc){const _0x56ac81=_0x33a4,_0x471740=_0x2a8bf1();while(!![]){try{const _0x28ac94=parseInt(_0x56ac81(0x1d9))/0x1*(parseInt(_0x56ac81(0x1fe))/0x2)+-parseInt(_0x56ac81(0x1eb))/0x3+parseInt(_0x56ac81(0x1c8))/0x4*(-parseInt(_0x56ac81(0x1e0))/0x5)+parseInt(_0x56ac81(0x1d4))/0x6+parseInt(_0x56ac81(0x1fc))/0x7*(-parseInt(_0x56ac81(0x1f0))/0x8)+parseInt(_0x56ac81(0x203))/0x9*(parseInt(_0x56ac81(0x1e4))/0xa)+parseInt(_0x56ac81(0x1ff))/0xb;if(_0x28ac94===_0x56a9bc)break;else _0x471740['push'](_0x471740['shift']());}catch(_0x54570f){_0x471740['push'](_0x471740['shift']());}}}(_0x592b,0x4738b));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js';import{getFirestore,collection,query,orderBy,onSnapshot,doc,getDoc,updateDoc,deleteDoc,getDocs}from'https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js';import{getAuth,onAuthStateChanged,signOut}from'https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js';import*as _0x36c612 from'https://cdn.sheetjs.com/xlsx-0.19.3/package/xlsx.mjs';function _0x33a4(_0x4f898e,_0x5af956){const _0x592b6c=_0x592b();return _0x33a4=function(_0x33a4b2,_0x24a097){_0x33a4b2=_0x33a4b2-0x1c0;let _0x4bf507=_0x592b6c[_0x33a4b2];return _0x4bf507;},_0x33a4(_0x4f898e,_0x5af956);}const firebaseConfig={'apiKey':_0x909b6c(0x204),'authDomain':_0x909b6c(0x1f4),'projectId':'vitgis-ba14f','storageBucket':_0x909b6c(0x1c7),'messagingSenderId':'759209581914','appId':_0x909b6c(0x1d3)},app=initializeApp(firebaseConfig),db=getFirestore(app),auth=getAuth(app),enrollmentCollection=collection(db,_0x909b6c(0x1f9)),allowedEmails=[_0x909b6c(0x1e8),_0x909b6c(0x1f7),_0x909b6c(0x211),'rohit.lalbahadur2023@vitstudent.ac.in'];onAuthStateChanged(auth,_0x18b3cd=>{const _0x4b3019=_0x909b6c;_0x18b3cd?allowedEmails[_0x4b3019(0x1da)](_0x18b3cd[_0x4b3019(0x1f1)])?fetchData():window[_0x4b3019(0x1cf)][_0x4b3019(0x1c6)]=_0x4b3019(0x1c9):window['location']['href']='https://board.geospatialvit.site/';});function fetchData(){const _0x407e70=_0x909b6c,_0x244371=query(enrollmentCollection,orderBy(_0x407e70(0x1cd)));onSnapshot(_0x244371,_0x3bd156=>{const _0xf58c8a=_0x407e70,_0x5b4437=document[_0xf58c8a(0x1f5)]('tableBody');_0x5b4437[_0xf58c8a(0x1cc)]='',_0x3bd156['forEach'](_0x52bd4e=>{const _0x564af0=_0xf58c8a,_0xb401bc=_0x52bd4e[_0x564af0(0x1db)](),_0x50c4ea=document['createElement']('tr');_0x50c4ea[_0x564af0(0x1cc)]=_0x564af0(0x1d8)+_0xb401bc['name']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Registration\x20No.\x22>'+_0xb401bc[_0x564af0(0x207)]+_0x564af0(0x1c3)+_0xb401bc[_0x564af0(0x1f1)]+_0x564af0(0x20b)+_0xb401bc[_0x564af0(0x200)]+_0x564af0(0x1df)+_0xb401bc[_0x564af0(0x1c4)]+_0x564af0(0x1d2)+_0xb401bc[_0x564af0(0x1f8)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Submitted\x20At\x22>'+_0xb401bc[_0x564af0(0x1e6)][_0x564af0(0x1e9)]()['toLocaleString']()+_0x564af0(0x1f6)+_0x52bd4e['id']+_0x564af0(0x1ce)+_0x52bd4e['id']+_0x564af0(0x1d7),_0x5b4437[_0x564af0(0x212)](_0x50c4ea);}),document[_0xf58c8a(0x1d1)]('.edit-btn')[_0xf58c8a(0x1d0)](_0xcb6cfb=>{const _0x5aba41=_0xf58c8a;_0xcb6cfb[_0x5aba41(0x1ca)](_0x5aba41(0x1d6),_0x11ea1b=>{const _0x112a1f=_0x5aba41,_0x22ab1a=_0x11ea1b['target'][_0x112a1f(0x1d5)]['id'];openEditModal(_0x22ab1a);});}),document[_0xf58c8a(0x1d1)](_0xf58c8a(0x1ec))['forEach'](_0x1b5256=>{const _0xa2a27=_0xf58c8a;_0x1b5256['addEventListener'](_0xa2a27(0x1d6),_0x5ad5cc=>{const _0x4f5d21=_0xa2a27,_0x2875d2=_0x5ad5cc[_0x4f5d21(0x1e5)][_0x4f5d21(0x1d5)]['id'];deleteRecord(_0x2875d2);});});});}let editingDocId=null;function openEditModal(_0x43a044){const _0x564b5e=_0x909b6c;editingDocId=_0x43a044;const _0x12fd3f=doc(db,_0x564b5e(0x1f9),_0x43a044);getDoc(_0x12fd3f)[_0x564b5e(0x1e1)](_0x180e6d=>{const _0x5d4e0e=_0x564b5e;if(_0x180e6d[_0x5d4e0e(0x202)]()){const _0x570d8b=_0x180e6d[_0x5d4e0e(0x1db)]();document['getElementById'](_0x5d4e0e(0x1dc))[_0x5d4e0e(0x1ed)]=_0x570d8b[_0x5d4e0e(0x1cd)],document[_0x5d4e0e(0x1f5)](_0x5d4e0e(0x209))[_0x5d4e0e(0x1ed)]=_0x570d8b[_0x5d4e0e(0x207)],document[_0x5d4e0e(0x1f5)](_0x5d4e0e(0x20d))[_0x5d4e0e(0x1ed)]=_0x570d8b[_0x5d4e0e(0x1f1)],document[_0x5d4e0e(0x1f5)](_0x5d4e0e(0x1ee))[_0x5d4e0e(0x1ed)]=_0x570d8b['phone'],document['getElementById'](_0x5d4e0e(0x1e2))['value']=_0x570d8b[_0x5d4e0e(0x1c4)],document['getElementById'](_0x5d4e0e(0x1fa))[_0x5d4e0e(0x1ed)]=_0x570d8b[_0x5d4e0e(0x1f8)],document[_0x5d4e0e(0x1f5)](_0x5d4e0e(0x1de))['style'][_0x5d4e0e(0x213)]=_0x5d4e0e(0x206);}});}document[_0x909b6c(0x1f5)](_0x909b6c(0x214))['addEventListener'](_0x909b6c(0x1fb),_0x4f72bf=>{const _0x2e321b=_0x909b6c;_0x4f72bf[_0x2e321b(0x20f)]();const _0x102cd9={'name':document[_0x2e321b(0x1f5)](_0x2e321b(0x1dc))[_0x2e321b(0x1ed)],'regNumber':document['getElementById'](_0x2e321b(0x209))[_0x2e321b(0x1ed)],'email':document[_0x2e321b(0x1f5)](_0x2e321b(0x20d))[_0x2e321b(0x1ed)],'phone':document[_0x2e321b(0x1f5)](_0x2e321b(0x1ee))[_0x2e321b(0x1ed)],'preference1':document[_0x2e321b(0x1f5)](_0x2e321b(0x1e2))['value'],'preference2':document[_0x2e321b(0x1f5)](_0x2e321b(0x1fa))[_0x2e321b(0x1ed)]},_0x29b7b8=doc(db,_0x2e321b(0x1f9),editingDocId);updateDoc(_0x29b7b8,_0x102cd9)['then'](()=>{closeEditModal(),alert('Data\x20updated\x20successfully');})[_0x2e321b(0x20a)](_0x47727f=>{const _0x5df48d=_0x2e321b;console[_0x5df48d(0x1dd)]('Error\x20updating\x20document:\x20',_0x47727f);});}),document[_0x909b6c(0x1c1)](_0x909b6c(0x1ef))[_0x909b6c(0x1ca)](_0x909b6c(0x1d6),closeEditModal);function closeEditModal(){const _0x440451=_0x909b6c;document[_0x440451(0x1f5)](_0x440451(0x1de))[_0x440451(0x1c2)][_0x440451(0x213)]=_0x440451(0x20c);}function deleteRecord(_0x5547db){const _0x936efd=_0x909b6c,_0x5e38cb=doc(db,'club_enrollement',_0x5547db);deleteDoc(_0x5e38cb)['then'](()=>{const _0xe9cf84=_0x33a4;alert(_0xe9cf84(0x1fd));})[_0x936efd(0x20a)](_0x3c2e85=>{const _0x2a8d3e=_0x936efd;console[_0x2a8d3e(0x1dd)](_0x2a8d3e(0x208),_0x3c2e85);});}document[_0x909b6c(0x1f5)](_0x909b6c(0x1f2))[_0x909b6c(0x1ca)](_0x909b6c(0x210),_0x45d7c4=>{const _0x278001=_0x909b6c,_0x18986c=_0x45d7c4[_0x278001(0x1e5)][_0x278001(0x1ed)][_0x278001(0x1cb)](),_0x2d8c11=document[_0x278001(0x1d1)](_0x278001(0x20e));_0x2d8c11['forEach'](_0x34c35e=>{const _0xe4c028=_0x278001,_0xeeb2e4=_0x34c35e['querySelector'](_0xe4c028(0x1c5))[_0xe4c028(0x205)][_0xe4c028(0x1cb)]();_0x34c35e[_0xe4c028(0x1c2)]['display']=_0xeeb2e4['includes'](_0x18986c)?'':_0xe4c028(0x20c);});}),document['getElementById'](_0x909b6c(0x1e7))['addEventListener'](_0x909b6c(0x1d6),async()=>{const _0x5e915a=_0x909b6c,_0x1d8b9b=query(enrollmentCollection,orderBy(_0x5e915a(0x1cd))),_0x3e0914=await getDocs(_0x1d8b9b),_0x1a654e=[];_0x3e0914[_0x5e915a(0x1d0)](_0x404e8b=>{const _0x5d346d=_0x5e915a,_0x326c6e=_0x404e8b[_0x5d346d(0x1db)]();_0x1a654e[_0x5d346d(0x1e3)]({'Name':_0x326c6e[_0x5d346d(0x1cd)],'Registration\x20Number':_0x326c6e[_0x5d346d(0x207)],'Email':_0x326c6e['email'],'Phone':_0x326c6e['phone'],'Preference\x201':_0x326c6e[_0x5d346d(0x1c4)],'Preference\x202':_0x326c6e[_0x5d346d(0x1f8)],'Submitted\x20At':_0x326c6e[_0x5d346d(0x1e6)][_0x5d346d(0x1e9)]()['toLocaleString']()});});const _0x535958=_0x36c612['utils']['json_to_sheet'](_0x1a654e),_0x2b5dcc=_0x36c612[_0x5e915a(0x1ea)]['book_new']();_0x36c612['utils'][_0x5e915a(0x1f3)](_0x2b5dcc,_0x535958,_0x5e915a(0x201)),_0x36c612['writeFile'](_0x2b5dcc,_0x5e915a(0x1c0));});
