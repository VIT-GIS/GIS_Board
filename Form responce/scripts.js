const _0x366d2d=_0x12a3;(function(_0x14a46d,_0x33cd05){const _0x52569b=_0x12a3,_0x46e7ea=_0x14a46d();while(!![]){try{const _0x3e5a4c=parseInt(_0x52569b(0x1d8))/0x1+parseInt(_0x52569b(0x1f9))/0x2+-parseInt(_0x52569b(0x1e9))/0x3*(-parseInt(_0x52569b(0x1de))/0x4)+-parseInt(_0x52569b(0x20c))/0x5+-parseInt(_0x52569b(0x1bf))/0x6+parseInt(_0x52569b(0x20b))/0x7*(parseInt(_0x52569b(0x1ea))/0x8)+-parseInt(_0x52569b(0x1f8))/0x9*(-parseInt(_0x52569b(0x208))/0xa);if(_0x3e5a4c===_0x33cd05)break;else _0x46e7ea['push'](_0x46e7ea['shift']());}catch(_0x666841){_0x46e7ea['push'](_0x46e7ea['shift']());}}}(_0x55fc,0x8584f));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js';import{getFirestore,collection,query,orderBy,onSnapshot,doc,getDoc,updateDoc,deleteDoc,getDocs}from'https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js';import{getAuth,onAuthStateChanged,signOut}from'https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js';import*as _0x56d316 from'https://cdn.sheetjs.com/xlsx-0.19.3/package/xlsx.mjs';const firebaseConfig={'apiKey':_0x366d2d(0x1c3),'authDomain':_0x366d2d(0x1cc),'projectId':_0x366d2d(0x209),'storageBucket':_0x366d2d(0x1dc),'messagingSenderId':_0x366d2d(0x1f2),'appId':_0x366d2d(0x1c5)},app=initializeApp(firebaseConfig),db=getFirestore(app),auth=getAuth(app),enrollmentCollection=collection(db,_0x366d2d(0x1eb)),allowedEmails=[_0x366d2d(0x1ec),_0x366d2d(0x1be),'raybanpranav.mahesh2023@vitstudent.ac.in',_0x366d2d(0x1e8)];function _0x12a3(_0x2648b4,_0x38cf24){const _0x55fce1=_0x55fc();return _0x12a3=function(_0x12a3e9,_0x2ed256){_0x12a3e9=_0x12a3e9-0x1bd;let _0x13b111=_0x55fce1[_0x12a3e9];return _0x13b111;},_0x12a3(_0x2648b4,_0x38cf24);}onAuthStateChanged(auth,_0x4bc3b3=>{const _0x114353=_0x366d2d;_0x4bc3b3?allowedEmails[_0x114353(0x1ee)](_0x4bc3b3[_0x114353(0x1df)])?fetchData():window[_0x114353(0x1e3)][_0x114353(0x1c2)]='https://board.geospatialvit.site/':window[_0x114353(0x1e3)][_0x114353(0x1c2)]='https://board.geospatialvit.site/';});function fetchData(){const _0x542d5e=_0x366d2d,_0x1aa3e8=query(enrollmentCollection,orderBy(_0x542d5e(0x1f5)));onSnapshot(_0x1aa3e8,_0xe81efe=>{const _0x242272=_0x542d5e,_0x12f244=document[_0x242272(0x20a)](_0x242272(0x1d7));_0x12f244['innerHTML']='';let _0x3604ae=0x1;_0xe81efe[_0x242272(0x1f0)](_0x6013e4=>{const _0x3e1df6=_0x242272,_0x192493=_0x6013e4[_0x3e1df6(0x1c9)](),_0xb2fa28=document[_0x3e1df6(0x1c7)]('tr');_0xb2fa28['innerHTML']=_0x3e1df6(0x1c1)+_0x3604ae++ +'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Name\x22>'+_0x192493[_0x3e1df6(0x1f5)]+_0x3e1df6(0x1d6)+_0x192493[_0x3e1df6(0x1c4)]+_0x3e1df6(0x1e2)+_0x192493[_0x3e1df6(0x1df)]+_0x3e1df6(0x1d5)+_0x192493[_0x3e1df6(0x1fe)]+_0x3e1df6(0x1e1)+_0x192493[_0x3e1df6(0x202)]+_0x3e1df6(0x1bd)+_0x192493[_0x3e1df6(0x200)]+_0x3e1df6(0x1c6)+_0x192493[_0x3e1df6(0x1ff)][_0x3e1df6(0x1e5)]()[_0x3e1df6(0x207)]()+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-btn\x22\x20data-id=\x22'+_0x6013e4['id']+'\x22>Edit</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-btn\x22\x20data-id=\x22'+_0x6013e4['id']+'\x22>Delete</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20',_0x12f244[_0x3e1df6(0x1f6)](_0xb2fa28);}),document['querySelectorAll'](_0x242272(0x1ed))[_0x242272(0x1f0)](_0x419934=>{const _0x4b0b5f=_0x242272;_0x419934[_0x4b0b5f(0x1fd)]('click',_0x1eaead=>{const _0x4078ba=_0x4b0b5f,_0x36e5d5=_0x1eaead[_0x4078ba(0x205)][_0x4078ba(0x1ef)]['id'];openEditModal(_0x36e5d5);});}),document[_0x242272(0x1d3)]('.delete-btn')[_0x242272(0x1f0)](_0x44c5ad=>{const _0x387aed=_0x242272;_0x44c5ad[_0x387aed(0x1fd)]('click',_0xf8e460=>{const _0x1c69bd=_0x387aed,_0x3e94d5=_0xf8e460[_0x1c69bd(0x205)][_0x1c69bd(0x1ef)]['id'];deleteRecord(_0x3e94d5);});});});}let editingDocId=null;function openEditModal(_0x790080){const _0x222964=_0x366d2d;editingDocId=_0x790080;const _0x24de17=doc(db,_0x222964(0x1eb),_0x790080);getDoc(_0x24de17)[_0x222964(0x1fb)](_0x8ad531=>{const _0x435c0d=_0x222964;if(_0x8ad531[_0x435c0d(0x1dd)]()){const _0x191555=_0x8ad531[_0x435c0d(0x1c9)]();document[_0x435c0d(0x20a)](_0x435c0d(0x1cd))['value']=_0x191555['name'],document[_0x435c0d(0x20a)]('editRegNumber')[_0x435c0d(0x1d9)]=_0x191555[_0x435c0d(0x1c4)],document[_0x435c0d(0x20a)]('editEmail')[_0x435c0d(0x1d9)]=_0x191555[_0x435c0d(0x1df)],document['getElementById'](_0x435c0d(0x1cf))['value']=_0x191555['phone'],document[_0x435c0d(0x20a)](_0x435c0d(0x1d4))['value']=_0x191555[_0x435c0d(0x202)],document[_0x435c0d(0x20a)](_0x435c0d(0x1e7))[_0x435c0d(0x1d9)]=_0x191555[_0x435c0d(0x200)],document[_0x435c0d(0x20a)](_0x435c0d(0x1cb))[_0x435c0d(0x1c8)]['display']=_0x435c0d(0x1c0);}});}document[_0x366d2d(0x20a)]('editForm')[_0x366d2d(0x1fd)](_0x366d2d(0x203),_0x429c6c=>{const _0x42a1ab=_0x366d2d;_0x429c6c[_0x42a1ab(0x1ce)]();const _0x4bf9aa={'name':document[_0x42a1ab(0x20a)](_0x42a1ab(0x1cd))[_0x42a1ab(0x1d9)],'regNumber':document[_0x42a1ab(0x20a)]('editRegNumber')['value'],'email':document[_0x42a1ab(0x20a)](_0x42a1ab(0x206))[_0x42a1ab(0x1d9)],'phone':document['getElementById'](_0x42a1ab(0x1cf))[_0x42a1ab(0x1d9)],'preference1':document[_0x42a1ab(0x20a)](_0x42a1ab(0x1d4))['value'],'preference2':document[_0x42a1ab(0x20a)](_0x42a1ab(0x1e7))[_0x42a1ab(0x1d9)]},_0x28f892=doc(db,_0x42a1ab(0x1eb),editingDocId);updateDoc(_0x28f892,_0x4bf9aa)[_0x42a1ab(0x1fb)](()=>{closeEditModal(),alert('Data\x20updated\x20successfully');})['catch'](_0x4783de=>{const _0x417445=_0x42a1ab;console[_0x417445(0x1e4)](_0x417445(0x1fa),_0x4783de);});}),document[_0x366d2d(0x1f1)](_0x366d2d(0x1e0))['addEventListener']('click',closeEditModal);function closeEditModal(){const _0x193a54=_0x366d2d;document[_0x193a54(0x20a)](_0x193a54(0x1cb))[_0x193a54(0x1c8)][_0x193a54(0x201)]=_0x193a54(0x1f3);}function deleteRecord(_0x8c3b46){const _0x32ba53=_0x366d2d,_0x4c6357=doc(db,'club_enrollement',_0x8c3b46);deleteDoc(_0x4c6357)[_0x32ba53(0x1fb)](()=>{alert('Record\x20deleted\x20successfully');})[_0x32ba53(0x1d1)](_0x1aeb3d=>{const _0x687188=_0x32ba53;console[_0x687188(0x1e4)]('Error\x20deleting\x20document:\x20',_0x1aeb3d);});}document[_0x366d2d(0x20a)]('searchInput')[_0x366d2d(0x1fd)](_0x366d2d(0x1d0),_0x37d06f=>{const _0x2a84e7=_0x366d2d,_0x4558e1=_0x37d06f[_0x2a84e7(0x205)][_0x2a84e7(0x1d9)]['toLowerCase'](),_0x14dacf=document['querySelectorAll']('#tableBody\x20tr');_0x14dacf[_0x2a84e7(0x1f0)](_0xceec71=>{const _0x15c707=_0x2a84e7,_0x25e12c=_0xceec71['querySelector']('td:nth-child(2)')[_0x15c707(0x1db)][_0x15c707(0x1f4)]();_0xceec71[_0x15c707(0x1c8)][_0x15c707(0x201)]=_0x25e12c['includes'](_0x4558e1)?'':_0x15c707(0x1f3);});}),document[_0x366d2d(0x20a)](_0x366d2d(0x1d2))['addEventListener'](_0x366d2d(0x1fc),async()=>{const _0x1d06df=_0x366d2d,_0xeef2ac=query(enrollmentCollection,orderBy(_0x1d06df(0x1f5))),_0x353576=await getDocs(_0xeef2ac),_0x397f24=[];_0x353576[_0x1d06df(0x1f0)](_0x1d6e1c=>{const _0x5ef0b8=_0x1d06df,_0x57ef13=_0x1d6e1c[_0x5ef0b8(0x1c9)]();_0x397f24[_0x5ef0b8(0x1e6)]({'Name':_0x57ef13[_0x5ef0b8(0x1f5)],'Registration\x20Number':_0x57ef13[_0x5ef0b8(0x1c4)],'Email':_0x57ef13['email'],'Phone':_0x57ef13['phone'],'Preference\x201':_0x57ef13['preference1'],'Preference\x202':_0x57ef13[_0x5ef0b8(0x200)],'Submitted\x20At':_0x57ef13[_0x5ef0b8(0x1ff)][_0x5ef0b8(0x1e5)]()['toLocaleString']()});});const _0x24126d=_0x56d316[_0x1d06df(0x204)][_0x1d06df(0x1ca)](_0x397f24),_0x4d4bd1=_0x56d316[_0x1d06df(0x204)]['book_new']();_0x56d316[_0x1d06df(0x204)]['book_append_sheet'](_0x4d4bd1,_0x24126d,_0x1d06df(0x1da)),_0x56d316['writeFile'](_0x4d4bd1,_0x1d06df(0x1f7));});function _0x55fc(){const _0x25e382=['.edit-btn','includes','dataset','forEach','querySelector','759209581914','none','toLowerCase','name','appendChild','Enrollment_Data.xlsx','150435wDEyii','162702XUxjEW','Error\x20updating\x20document:\x20','then','click','addEventListener','phone','timestamp','preference2','display','preference1','submit','utils','target','editEmail','toLocaleString','190kGfFzV','vitgis-ba14f','getElementById','49TwZUYu','554910IzcquE','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Preference\x202\x22>','ajitesh.sharma2023@vitstudent.ac.in','5765130ZjxzPt','block','\x0a\x20\x20\x20\x20\x20\x20<td>','href','AIzaSyCvg1AhjEd9vIiYWgqQlI5BO0jU3AF84t8','regNumber','1:759209581914:web:3432c0511eba57eca66763','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Submitted\x20At\x22>','createElement','style','data','json_to_sheet','editModal','vitgis-ba14f.firebaseapp.com','editName','preventDefault','editPhone','input','catch','downloadExcel','querySelectorAll','editPreference1','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Phone\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Registration\x20No.\x22>','tableBody','894376MiBmOs','value','Enrollment\x20Data','textContent','vitgis-ba14f.appspot.com','exists','12SSNMMF','email','.close-btn','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Preference\x201\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td\x20data-label=\x22Email\x22>','location','error','toDate','push','editPreference2','rohit.lalbahadur2023@vitstudent.ac.in','262077EEYWpU','72392HchwfR','club_enrollement','sahildinesh.zambre2023@vitstudent.ac.in'];_0x55fc=function(){return _0x25e382;};return _0x55fc();}
